---
title: 计算机网络总结
tags: [计算机网络, 基础知识学习]
style: fill
color: dark
description: 计算机网络中涉及到的知识.
---

# 1 概述

## 网络的网络

网络将主机连接起来，互联网将网络连接起来。因特网是全球范围的互联网。


## ISP

Internet Service Provider：从互联网管理机构获得IP地址，同时拥有通信线路及路由器等联网设备。

ISP根据覆盖面积分为：第一层ISP、区域ISP、接入ISP。互联网交换点IXP允许两个ISP直接相连而不用经过第三个ISP。


## 主机间的通信方式

C/S、P2P


## 电路交换与分组交换

* 电路交换：建立一条专用的物理链路用于数据传输，整个通信过程中始终占用该链路。利用率低。

* 分组交换：每个分组设置头部、尾部，其包含源地址、目的地址等控制信息。同一条链路上可以传输不同分组，互不影响。


## 时延

<center>总时延 = 排队时延 + 处理时延 + 传输时延 + 传播时延</center>

* 排队时延：分组在路由器的输入及输出队列的等待时间；
* 处理时延：路由器处理分组所需的时间（分析首部、差错检验等）
* 传输时延：主机或路由器传输数据所需的时间。$$delay = \frac{l(bit)}{v(bit/s)}$$
* 传播时延：电磁波在信道中传播所需的时间。 $$delay = \frac{l(m)}{v(m/s)}$$


## 计算机网络体系结构

常见的有：OSI、五层协议、TCP/IP

### 五层协议

|(由上到下)|
| --- |
| 应用层 |
| 运输层/传输层 |
| 网络层 |
| 数据链路层 |
| 物理层 |

* 应用层：为特定应用提供数据传输服务，利用HTTP、DNS等。数据单位为报文。
* 传输层：为进程提供通用数据传输服务。运输层包括传输控制协议（TCP）及用户数据报（UDP）两种协议。TCP提供面向连接、可靠的数据传输服务，数据单位为报文段；UDP提供无连接、尽最大努力的数据传输服务，数据单位为用户数据报。TCP主要提供完整性服务，UDP主要提供及时性服务。
* 网络层：为主机间提供数据传输服务，将传输层传递下来的报文段或者用户数据报封装成分组。
* 数据链路层：同样为主机间提供数据传输服务，而主机间可能存在多条链路。数据链路层为同一链路下的主机提供数据传输服务。数据链路层将网络层传下来的分组封装成帧。
* 物理层：考虑如何在传输媒体上传输数据比特流，其屏蔽了传输媒体和通信手段的差异。

### OSI

|(由上到下)|
| --- |
| 应用层 |
| 表示层 |
| 会话层 |
| 运输层 |
| 网络层 |
| 数据链路层 |
| 物理层 |

* 表示层：数据压缩、加密及数据描述，使得应用程序不必关心在各台主机中内部格式不同的问题。
* 会话层：建立及管理会话。

五层协议中没有表示层和会话层，而是将这些功能留给程序开发者处理。


### TCP/TP

|(由上到下)|
| --- |
| 应用层 |
| 运输层 |
| 网际层 |
| 网络接口层 |

TCP/IP将物理层和数据链路层合并为网络接口层。

TCP/IP体系结构不严格遵循OSI分层概念，应用层可能直接访问网络层或传输层。


### 传递过程

在向下的过程中，需要添加下层协议所需要的首部或尾部，而在向上的过程中不断拆开首部和尾部。

路由器工作在网络层中。


# 2 物理层

## 通信方式

根据信息在传输线上的传送方向，分为以下几种通信方式：

* 单工通信：单向传输
* 半双工通信：双向交替传输
* 全双工通信：双向同时传输

## 带通调制

模拟信号：连续的信号
数字信号：离散的信号
带通调制：将数字信号转化为模拟信号


# 3 链路层

## 3.1 基本问题

### 封装成帧

将网络层传下来的分组添加首部和尾部，用于标记帧的开始和结束

```C++
首部 + IP数据报 + 尾部
```

### 透明传输

如果帧的数据部分含有和首部尾部相同的内容，那么帧的开始和结束位置就会被错误地判定。

解决方法：在数据部分中出现与首部尾部相同内容的前面插入转义字符。在接收端进行处理后可以还原出原始数据，该过程透明传输的内容是转义字符，用户觉感知不到转义字符的存在。

### 差错检测

通过循环冗余检验(CRC)来检查比特差错。


## 3.2 信道分类

### 广播信道

一对多通信，一个节点发送的数据能够被广播信道上的所有节点接收到。

所有节点在同一广播上发送数据，可能会发生碰撞。解决方法：
   * 信道复用技术
   * CSMA/CD

### 点对点信道

一对一通信，不会发生碰撞，使用PPP协议进行控制。


## 3.3 信道复用技术

* 频分复用：所有主机在相同的时间点占用不同的频率带宽资源。
* 时分复用：所有主机在不同的时间点占用相同的频率带宽资源。
* 统计时分复用：不固定每个用户在时分复用帧中的位置，只要有数据就集中起来组成统计时分复用帧然后发送。
* 波分复用：光的频分复用。由于光的频率很高，因此习惯上用波长而不是频率来表示所使用的光载波。
* 码分复用：码分复用。为每个用户分配$$m$$比特的码片，使所有码片正交，当用户发送1时就发送该码片，发送0时发送该码片的反码。缺点是需要发送的数据量变为原来的$$m$$倍。


## 3.4 CSMA/CD协议

CSMA/CD：载波监听多点接入/碰撞检测。
   * 多点接入：说明这是总线型网络，多台主机以多点的方式连接到总线上；
   * 载波监听：每个主机都必须不停地监听信道。在发送前，如果监听到信道正在使用则必须等待；
   * 碰撞检测：在发送中，如果监听到信道已有其它主机正在发送数据，就发生了碰撞。虽然每个主机在发送数据之前就已经监听到信道为空闲，但是由于电磁波传播时延的存在，依然可能发生碰撞。

发生碰撞时，站点要停止发送，等待一段时间后再继续发送，这个时间采用*截断二进制指数退避算法*决定。

## 3.5 PPP协议 

用户计算机和ISP进行通信时所使用的数据链路层协议。

PPP的帧格式：

```C++
F + A + C + 协议 + IP数据报 + FCS + F
```

* F：帧的定界符
* A和C：暂时没有意义
* FCS：使用CRC的检验序列
* 信息部分的长度不超过1500


## 3.6 MAC地址

MAC地址是链路层地址，长度为6字节(48位)，用于唯一标识网络适配器。一台主机有多少个网络适配器就有多少个MAC地址。


## 3.7 局域网

一种典型的广播信道，主要特点是网络为一个单位所拥有，且地理范围和站点数目均有限。

主要有以太网、令牌环网、FDDI、ATM等技术，目前以以太网为主

分类：星型、环型、直线型


## 3.8 以太网

一种星型拓扑结构局域网。

早期使用集线器连接，但可能发生碰撞。目前使用交换机连接，其根据MAC地址进行存储转发，不会发生碰撞。

以太网帧格式：

* 类型：标记上层使用的协议；
* 数据：长度在46-1500之间，如果太小则需要填充；
* FCS：帧检验序列，使用CRC检验法。

```C++
目的地址 + 源地址 + 类型 + IP数据报 + FCS
 6bit      6bit    2bit   46-1500    4
```


## 3.9 交换机

交换机具有学习能力，学习的是交换表的内容，交换表中存储着MAC地址到接口的映射。

主机A向主机B，传输数据时，如果主机B不在交换表中，则主机A发送广播帧，其它主机丢弃该帧，主机B接到帧后进行回应，并将自己的地址写入交换表。


## 3.10 虚拟局域网

虚拟局域网(VLAN)可以建立与物理位置无关的逻辑组，只有在同一个虚拟局域网中的成员才会收到链路层广播信息。
